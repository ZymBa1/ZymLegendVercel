<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>ZymLegend Online</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <link rel="stylesheet" href="style.css">

  <!-- Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <header>
    <h1 id="gameTitle">ZymLegend Online</h1>
    <div id="topBar">
      <span id="accountStatus">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–æ–≤</span>
      <button id="settingsBtn">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>
  </header>

  <main>
    <!-- Menu -->
    <section id="menu" class="screen active">
      <div class="menuButtons">
        <button onclick="startSingle()">–ò–≥—Ä–∞—Ç—å –û–¥–∏–Ω–æ—á–Ω—ã–π</button>
        <button onclick="openServers()">–û–Ω–ª–∞–π–Ω </button>
        <button onclick="openAccounts()">–ê–∫–∫–∞—É–Ω—Ç—ã</button>
        <button onclick="openSkins()">–°–∫–∏–Ω—ã</button>
      </div>
      <div id="currentServerBadge" class="badge"></div>
    </section>

    <!-- Servers browser -->
    <section id="servers" class="screen">
      <button class="backBtn" onclick="openMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
      <h2>–°–µ—Ä–≤–µ—Ä—ã</h2>
      <div class="serverActions">
        <button onclick="openAddServer()">Ôºã –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
      </div>
      <div id="serverList" class="serverList"></div>

      <!-- Modal -->
      <div id="serverModal" class="modal hidden">
        <div class="modalBox">
          <h3 id="serverModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</h3>
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
          <input id="srvName" class="inputBox" placeholder="My Server">
          <label>–ê–¥—Ä–µ—Å (ws:// –∏–ª–∏ wss://)</label>
          <input id="srvAddr" class="inputBox" placeholder="wss://example.com">
          <label>–Ø–∑—ã–∫</label>
          <select id="srvLang" class="inputBox">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
          </select>
          <div class="modalBtns">
            <button onclick="closeServerModal()">–û—Ç–º–µ–Ω–∞</button>
            <button id="serverModalSaveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Game -->
    <section id="game" class="screen">
      <button id="homeBtn" onclick="goHome()" class="homeBtn">üè† –î–æ–º–æ–π</button>
      <canvas id="gameCanvas" width="900" height="520"></canvas>
      <div id="hud">
        <div id="status">HP: 100 | –í—Ä–∞–≥–æ–≤: 0</div>
        <div id="xpStatus">XP: 0 | Level: 1</div>
        <div id="serverConnection" class="muted">Offline</div>
      </div>

      <!-- Joysticks -->
      <div id="joystickMove" class="joystick" draggable="false"><div class="stick"></div></div>
      <div id="joystickShoot" class="joystick" draggable="false"><div class="stick"></div></div>
    </section>

    <!-- Accounts -->
    <section id="accounts" class="screen">
      <button class="backBtn" onclick="openMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
      <h2>–ê–∫–∫–∞—É–Ω—Ç—ã</h2>
      <div class="accountsBlock">
        <button onclick="connectTelegram()">Telegram WebApp</button>
        <button onclick="openZLAuth()">ZLAccount</button>
      </div>

      <h3>–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google</h3>
      <div id="g_id_onload"
           data-client_id="913407850801-0fm9mo59pmbsj6dln94fs6o7pt3l9fuh.apps.googleusercontent.com/"
           data-callback="handleGoogleResponse"></div>
      <div class="g_id_signin"
           data-type="standard" data-size="large" data-theme="outline"
           data-text="signin_with" data-shape="rect" data-logo_alignment="left"></div>

      <div style="margin-top:12px;">
        <button onclick="logoutAll()">–í—ã–π—Ç–∏ –∏–∑ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤</button>
      </div>
    </section>

    <!-- ZLAccount -->
    <section id="zlAuth" class="screen">
      <button class="backBtn" onclick="openAccounts()">‚¨Ö –ù–∞–∑–∞–¥</button>
      <h2>ZLAccount</h2>
      <input id="zlLogin" class="inputBox" placeholder="–õ–æ–≥–∏–Ω"><br/>
      <input id="zlPass" type="password" class="inputBox" placeholder="–ü–∞—Ä–æ–ª—å"><br/>
      <button onclick="zlRegister()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      <button onclick="zlLoginFunc()">–í—Ö–æ–¥</button>
      <p id="zlMsg"></p>
    </section>

    <!-- Skins -->
    <section id="skins" class="screen">
      <button class="backBtn" onclick="openMenu()">‚¨Ö –ù–∞–∑–∞–¥</button>
      <h2>–°–∫–∏–Ω—ã</h2>
      <div id="skinList" class="skinList"></div>
    </section>

    <!-- Settings -->
    <section id="settings" class="screen">
      <button class="backBtn" onclick="closeSettings()">‚¨Ö –ù–∞–∑–∞–¥</button>
      <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

      <div class="settingSection">
        <h3>–Ø–∑—ã–∫</h3>
        <select id="langSelect">
          <option value="ru">–†—É—Å—Å–∫–∏–π</option>
          <option value="en">English</option>
        </select>
      </div>

      <div class="settingSection">
        <h3>–¶–≤–µ—Ç —Ñ–æ–Ω–∞</h3>
        <select id="bgColorSelect">
          <option value="#111">–ß–µ—Ä–Ω—ã–π</option>
          <option value="#001f3f">–°–∏–Ω–∏–π</option>
          <option value="#013220">–ó–µ–ª–µ–Ω—ã–π</option>
          <option value="#2e003e">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</option>
        </select>
      </div>

      <div class="settingSection">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ü–ö)</h3>
        <div id="keyMapList"></div>
        <p class="hint">–ù–∞–∂–º–∏ "–ò–∑–º–µ–Ω–∏—Ç—å" –∏ –∑–∞—Ç–µ–º –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É, —á—Ç–æ–±—ã –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å.</p>
      </div>

      <div class="settingSection">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–¢–µ–ª–µ—Ñ–æ–Ω)</h3>
        <label><input type="checkbox" id="enableShootJoystick"> –í–∫–ª—é—á–∏—Ç—å –¥–∂–æ–π—Å—Ç–∏–∫ –¥–ª—è —Å—Ç—Ä–µ–ª—å–±—ã</label><br/>
        <label><input type="checkbox" id="movableJoysticks"> –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¥–∂–æ–π—Å—Ç–∏–∫–æ–≤</label>
        <div class="hint">–ü–µ—Ä–µ–º–µ—â–∞–π –¥–∂–æ–π—Å—Ç–∏–∫–∏ –≤ –∏–≥—Ä–æ–≤–æ–º —ç–∫—Ä–∞–Ω–µ, –∏—Ö –ø–æ–∑–∏—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.</div>
      </div>

      <div class="settingSection">
        <h3>–ê–∫–∫–∞—É–Ω—Ç—ã</h3>
        <button onclick="logoutTelegram()">–í—ã–π—Ç–∏ Telegram</button>
        <button onclick="logoutGoogle()">–í—ã–π—Ç–∏ Google</button>
        <button onclick="logoutZL()">–í—ã–π—Ç–∏ ZLAccount</button>
      </div>

      <div style="margin-top:16px;">
        <button onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      </div>
    </section>
  </main>

  <footer><small>ZymLegend ‚Äî Fix update 1.1</small></footer>

  <script src="game.js"></script>
</body>
</html>
